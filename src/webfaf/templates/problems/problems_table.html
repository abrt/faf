{% macro problems_table(problems) %}
    {% if problems %}
      <table class="table table-striped table-bordered table-condensed">
        <thead>
          <tr>
            <th>ID</th>
            <th>Component</th>
            <th>Crash function</th>
            <th>State</th>
            <th>External bugs</th>
            <th class="cursor-help" title="Version of the oldest affected package since which the problem stopped occuring in the given release.">Probably fixed</th>
            <th>Count</th>
          </tr>
        </thead>
        </tbody>
            {%- for problem in problems %}
              <tr>
                <td>
                  <a href="{{ url_for('problems.item', problem_id=problem.id) }}">
                    {{ problem.id }}
                  </a>
                </td>
                <td>
                    {% set components = problem.components.split(", ") %}
                      <b>{{ problem.components }}</b>
                    {% if components|length != problem.comp_count %}
                      ({{ problem.comp_count - components|length }} more)
                    {% endif %}
                    {% if not problem.untainted_count %}
                      <span class="label label-warning">Tainted</span>
                    {% endif %}
                </td>
                <td>
                    {%- if problem.crashfn %}
                      {{ problem.crashfn|truncate(50, True) }}
                    {%- endif %}
                </td>
                <td>
                    {% set bug_status = problem.bz_status if problem.bz_status not in (none, "NEW") else problem.mantis_status %}
                    {% set status = "NEW" if bug_status is none else bug_status %}
                    <span class="label label-{{ status|problem_label }}">
                      {{ status }}
                    </span>
                </td>
                <td>
                  {{ problem.mantisbugs_count + problem.bzbugs_count}}
                </td>
                <td>
                    {%- if problem.pkg_name %}
                      {% set os = problem.opsys.split(", ") %}
                      {% set os_rel = problem.opsys_release.split(", ") %}
                      {% set comp = problem.pkg_name.split(", ") %}
                      {% set comp_ver = problem.pkg_version.split(", ") %}
                      {% set comp_rel = problem.pkg_release.split(", ") %}
                      {% for o in os %}
                        {{ o }} {{ os_rel[loop.index0] }}: {{ comp[loop.index0] }}-{{
                           comp_ver[loop.index0]}}-{{ comp_rel[loop.index0] }}
                      {%- endfor %}
                    {%- endif %}
                </td>
                <td>{{ problem.count }}</td>
              </tr>
            {%- endfor %}
        </tbody>
      </table>
    {% else %}
      <h3>No data to display</h3>
    {% endif %}
{% endmacro %}
